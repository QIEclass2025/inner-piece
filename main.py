import sys
import time
import random
import os

# ==========================================
# [1] ë°ì´í„° ì„¤ê³„ ë° ìƒìˆ˜ ì •ì˜
# ==========================================

# ê¸°íšì„œ 2.2í•­: ABCDE ëª¨ë¸ ë°ì´í„°ë¥¼ ë‹´ì„ í´ë˜ìŠ¤
class MentalRecord:
    def __init__(self, adversity, belief, consequence, disputation, effect):
        self.adversity = adversity  # A: ì„ í–‰ì‚¬ê±´
        self.belief = belief        # B: ì‹ ë… (ë¹„í•©ë¦¬ì  ìƒê°)
        self.consequence = consequence # C: ê²°ê³¼ (ê°ì • ê°•ë„ 1~10)
        self.disputation = disputation # D: ë…¼ë°•
        self.effect = effect        # E: íš¨ê³¼ (í•©ë¦¬ì  ì‹ ë…)
        self.date = time.strftime('%Y-%m-%d %H:%M:%S') # ê¸°ë¡ ì‹œê°„

    # ê°ì²´ ì •ë³´ë¥¼ ë¬¸ìì—´ë¡œ ë°˜í™˜ (ì €ì¥/ì¶œë ¥ìš©)
    def __str__(self):
        return f"[{self.date}] ì‚¬ê±´: {self.adversity} | ê°ì •ì ìˆ˜: {self.consequence}"

# ê¸°íšì„œ 2.2 (2)í•­: ë…¼ë°•(D) ë‹¨ê³„ì—ì„œ ì‚¬ìš©í•  'ê°€ì§œ AI' ì§ˆë¬¸ ë¦¬ìŠ¤íŠ¸
QUESTION_BANK = [
    "ê·¸ ìƒê°ì´ 100% ì‚¬ì‹¤ì´ë¼ëŠ” í™•ì‹¤í•œ ë²•ì  ì¦ê±°ê°€ ìˆìŠµë‹ˆê¹Œ?",
    "ê·¸ë ‡ê²Œ ìƒê°í•˜ëŠ” ê²ƒì´ ì§€ê¸ˆ ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë° ì‹¤ì œë¡œ ë„ì›€ì´ ë©ë‹ˆê¹Œ?",
    "ê°€ì¥ ì¹œí•œ ì¹œêµ¬ê°€ ë‚˜ì™€ ë˜‘ê°™ì€ ìƒí™©ì— ì²˜í–ˆë‹¤ë©´, ì¹œêµ¬ì—ê²Œë„ ê·¸ë ‡ê²Œ ë§í•´ì¤„ ê±´ê°€ìš”?",
    "ì´ ìƒí™©ì„ ê¸ì •ì ìœ¼ë¡œ, í˜¹ì€ ë°°ìš¸ ì ìœ¼ë¡œ í•´ì„í•  ìˆ˜ ìˆëŠ” ì—¬ì§€ëŠ” ì „í˜€ ì—†ë‚˜ìš”?",
    "1ë…„ ë’¤ì—ë„ ì´ ì¼ì´ ì§€ê¸ˆì²˜ëŸ¼ ë‚´ ì¸ìƒì„ ë’¤í”ë“¤ ë§Œí¼ ì‹¬ê°í• ê¹Œìš”?"
]

# ==========================================
# [2] í•µì‹¬ ê¸°ëŠ¥ í•¨ìˆ˜ êµ¬í˜„
# ==========================================

def sos_mode():
    """
    ê¸°íšì„œ 2.2 (1): ê¸‰ì„± ìŠ¤íŠ¸ë ˆìŠ¤ ì™„í™” (SOS ëª¨ë“œ)
    4-7-8 í˜¸í¡ë²•ì„ í…ìŠ¤íŠ¸ì™€ íƒ€ì´ë¨¸ë¡œ ì•ˆë‚´
    """
    print("\n" + "="*40)
    print("   [SOS ëª¨ë“œ] 4-7-8 í˜¸í¡ í…Œë¼í”¼")
    print("="*40)
    print("ê¸´ì¥ì„ í’€ê³  í™”ë©´ì˜ ì§€ì‹œì— ë”°ë¼ í˜¸í¡í•˜ì„¸ìš”.")
    print("ì¤€ë¹„ë˜ì…¨ìœ¼ë©´ Enterë¥¼ ëˆ„ë¥´ì„¸ìš”...", end="")
    input()

    # ê°„ë‹¨í•˜ê²Œ 3ì„¸íŠ¸ë§Œ ë°˜ë³µ (ì‹¤ì œ êµ¬í˜„ ì‹œ ëŠ˜ë¦´ ìˆ˜ ìˆìŒ)
    for i in range(1, 4):
        print(f"\n[Cycle {i}/3]")
        
        print("ë“¤ì´ë§ˆì‹œì„¸ìš” (4ì´ˆ) ... í¡!", end="")
        sys.stdout.flush()
        time.sleep(4)
        print(" ì™„ë£Œ")
        
        print("ì°¸ìœ¼ì„¸ìš” (7ì´ˆ) ....... ë©ˆì¶¤", end="")
        sys.stdout.flush()
        time.sleep(7)
        print(" ì™„ë£Œ")
        
        print("ë‚´ë±‰ìœ¼ì„¸ìš” (8ì´ˆ) ..... í›„~", end="")
        sys.stdout.flush()
        time.sleep(8)
        print(" ì™„ë£Œ")
    
    print("\n[ì•ˆë‚´] í˜¸í¡ì´ ëë‚¬ìŠµë‹ˆë‹¤. ë§ˆìŒì´ ì¡°ê¸ˆ í¸ì•ˆí•´ì§€ì…¨ë‚˜ìš”?")
    input("ë©”ë‰´ë¡œ ëŒì•„ê°€ë ¤ë©´ Enterë¥¼ ëˆ„ë¥´ì„¸ìš”.")

def abcde_training():
    """
    ê¸°íšì„œ 2.2 (2): ì‚¬ê³  ì „í™˜ í›ˆë ¨ (ABCDE ëª¨ë¸)
    ì‚¬ìš©ì ì…ë ¥ì„ ë°›ê³ , ëœë¤ ì§ˆë¬¸ì„ ë˜ì§„ í›„ ê²°ê³¼ë¥¼ ì €ì¥
    """
    print("\n" + "="*40)
    print("   [ì‚¬ê³  ì „í™˜ í›ˆë ¨] ABCDE ëª¨ë¸ë§")
    print("="*40)
    
    # [cite_start]A: ì„ í–‰ì‚¬ê±´ [cite: 26]
    adversity = input("\n[A] ì–´ë–¤ ì‚¬ê±´ ë•Œë¬¸ì— ìŠ¤íŠ¸ë ˆìŠ¤ë¥¼ ë°›ìœ¼ì…¨ë‚˜ìš”?\n>> ")
    
    # [cite_start]B: ì‹ ë… [cite: 27]
    belief = input("\n[B] ê·¸ ì‚¬ê±´ì— ëŒ€í•´ ìˆœê°„ì ìœ¼ë¡œ ë“  ìƒê°ì€ ë¬´ì—‡ì¸ê°€ìš”?\n>> ")
    
    # [cite_start]C: ê²°ê³¼ [cite: 28]
    while True:
        try:
            consequence = int(input("\n[C] ê·¸ë¡œ ì¸í•œ ê°ì •ì˜ ê³ í†µì„ 1~10 ì‚¬ì´ ìˆ«ìë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.\n>> "))
            if 1 <= consequence <= 10:
                break
            print("1ì—ì„œ 10 ì‚¬ì´ì˜ ìˆ«ìë¡œë§Œ ì…ë ¥í•´ì£¼ì„¸ìš”.")
        except ValueError:
            print("ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")

    # [cite_start]D: ë…¼ë°• (í•µì‹¬ ê¸°ëŠ¥) [cite: 29, 30]
    print("\n" + "-"*40)
    print("ğŸ¤– Inner-Peace AIê°€ ë‹¹ì‹ ì˜ ìƒê°ì— ëŒ€í•´ ë¬»ìŠµë‹ˆë‹¤:")
    ai_question = random.choice(QUESTION_BANK) # ëœë¤ ì§ˆë¬¸ ì„ íƒ
    print(f"\"{ai_question}\"")
    print("-"*40)
    
    disputation = input("\n[D] ìœ„ ì§ˆë¬¸ì— ëŒ€í•´ ìŠ¤ìŠ¤ë¡œ ë°˜ë°•í•˜ê±°ë‚˜ ë‹µë³€í•´ ë³´ì„¸ìš”.\n>> ")

    # [cite_start]E: íš¨ê³¼ [cite: 31]
    effect = input("\n[E] ë…¼ë°•ì„ í†µí•´ ìƒˆë¡­ê²Œ ì •ë¦¬ëœ í•©ë¦¬ì ì¸ ìƒê°ì€ ë¬´ì—‡ì¸ê°€ìš”?\n>> ")

    # ê°ì²´ ìƒì„± (ë‚˜ì¤‘ì— íŒŒì¼ ì €ì¥ ê¸°ëŠ¥ê³¼ ì—°ê²°)
    record = MentalRecord(adversity, belief, consequence, disputation, effect)
    
    print("\n[ì €ì¥ ì™„ë£Œ] ì„±ê³µì ìœ¼ë¡œ ê¸°ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. (í˜„ì¬ëŠ” ë©”ëª¨ë¦¬ì—ë§Œ ì €ì¥ë¨)")
    # TODO: ì—¬ê¸°ì„œ save_file(record) ê°™ì€ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ì•¼ í•¨
    input("ë©”ë‰´ë¡œ ëŒì•„ê°€ë ¤ë©´ Enterë¥¼ ëˆ„ë¥´ì„¸ìš”.")

def view_history():
    """
    ê¸°íšì„œ 2.2 (3): ì‚¬ê³  ê¸°ë¡ ì¡°íšŒ
    """
    print("\n[ê¸°ë¡ ì¡°íšŒ] í˜„ì¬ëŠ” íŒŒì¼ ì €ì¥ ê¸°ëŠ¥ì´ êµ¬í˜„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
    # TODO: íŒŒì¼ ì…ì¶œë ¥ êµ¬í˜„ í›„ ì—°ë™
    input("ë©”ë‰´ë¡œ ëŒì•„ê°€ë ¤ë©´ Enterë¥¼ ëˆ„ë¥´ì„¸ìš”.")

# ==========================================
# [3] ë©”ì¸ í™”ë©´ ë° ë£¨í”„
# ==========================================

def print_menu():
    # [cite_start]ê¸°íšì„œ 2.1: ë©”ì¸ ë©”ë‰´ êµ¬ì„± [cite: 13-18]
    os.system('cls' if os.name == 'nt' else 'clear') # í™”ë©´ ì§€ìš°ê¸° (ì„ íƒì‚¬í•­)
    print("\n" + "â– "*40)
    print("      Inner-Peace : ë§ˆìŒ ì±™ê¹€ ë„êµ¬")
    print("â– "*40)
    print("1. ê¸‰ì„± ìŠ¤íŠ¸ë ˆìŠ¤ ì™„í™” (SOS ëª¨ë“œ)")
    print("2. ì‚¬ê³  ì „í™˜ í›ˆë ¨ (ABCDE ëª¨ë¸ë§)")
    print("3. ì‚¬ê³  ê¸°ë¡ ì¡°íšŒ (History)")
    print("4. í”„ë¡œê·¸ë¨ ì¢…ë£Œ")
    print("-" * 40)

def main():
    while True:
        print_menu()
        choice = input("ì›í•˜ëŠ” ê¸°ëŠ¥ì„ ì„ íƒí•˜ì„¸ìš” >> ")

        if choice == '1':
            sos_mode()
        elif choice == '2':
            abcde_training()
        elif choice == '3':
            view_history()
        elif choice == '4':
            print("\ní”„ë¡œê·¸ë¨ì„ ì¢…ë£Œí•©ë‹ˆë‹¤. ì˜¤ëŠ˜ë„ í‰ì•ˆí•˜ì„¸ìš”.")
            sys.exit()
        else:
            print("\n[!] ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤.")
            time.sleep(1)

if __name__ == "__main__":
    main()